/**
 * Trumbowyg v2.25.1 - A lightweight WYSIWYG editor
 * Trumbowyg core file
 * ------------------------
 * @link http://alex-d.github.io/Trumbowyg
 * @license MIT
 * @author Alexandre Demode (Alex-D)
 *         Twitter : @AlexandreDemode
 *         Website : alex-d.fr
 */jQuery.trumbowyg={langs:{en:{viewHTML:"View HTML",undo:"Undo",redo:"Redo",formatting:"Formatting",p:"Paragraph",blockquote:"Quote",code:"Code",header:"Header",bold:"Bold",italic:"Italic",strikethrough:"Strikethrough",underline:"Underline",strong:"Strong",em:"Emphasis",del:"Deleted",superscript:"Superscript",subscript:"Subscript",unorderedList:"Unordered list",orderedList:"Ordered list",insertImage:"Insert Image",link:"Link",createLink:"Insert link",unlink:"Remove link",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",horizontalRule:"Insert horizontal rule",removeformat:"Remove format",fullscreen:"Fullscreen",close:"Close",submit:"Confirm",reset:"Cancel",required:"Required",description:"Description",title:"Title",text:"Text",target:"Target",width:"Width"}},plugins:{},svgPath:null,svgAbsoluteUseHref:!1,hideButtonTexts:null};Object.defineProperty(jQuery.trumbowyg,"defaultOptions",{value:{lang:"en",fixedBtnPane:!1,fixedFullWidth:!1,autogrow:!1,autogrowOnEnter:!1,imageWidthModalEdit:!1,hideButtonTexts:null,prefix:"trumbowyg-",tagClasses:{},semantic:!0,semanticKeepAttributes:!1,resetCss:!1,removeformatPasted:!1,tabToIndent:!1,tagsToRemove:[],tagsToKeep:["hr","img","embed","iframe","input"],btns:[["viewHTML"],["undo","redo"],["formatting"],["strong","em","del"],["superscript","subscript"],["link"],["insertImage"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["unorderedList","orderedList"],["horizontalRule"],["removeformat"],["fullscreen"]],btnsDef:{},changeActiveDropdownIcon:!1,inlineElementsSelector:"a,abbr,acronym,b,caption,cite,code,col,dfn,dir,dt,dd,em,font,hr,i,kbd,li,q,span,strikeout,strong,sub,sup,u",pasteHandlers:[],plugins:{},urlProtocol:!1,minimalLinks:!1,defaultLinkTarget:void 0,svgPath:null},writable:!1,enumerable:!0,configurable:!1});(function(b,p,w,r){var m="tbwconfirm",y="tbwcancel";r.fn.trumbowyg=function(e,t){var n="trumbowyg";if(e===Object(e)||!e)return this.each(function(){r(this).data(n)||r(this).data(n,new C(this,e))});if(this.length===1)try{var a=r(this).data(n);switch(e){case"execCmd":return a.execCmd(t.cmd,t.param,t.forceCss,t.skipTrumbowyg);case"openModal":return a.openModal(t.title,t.content);case"closeModal":return a.closeModal();case"openModalInsert":return a.openModalInsert(t.title,t.fields,t.callback);case"saveRange":return a.saveRange();case"getRange":return a.range;case"getRangeText":return a.getRangeText();case"restoreRange":return a.restoreRange();case"enable":return a.setDisabled(!1);case"disable":return a.setDisabled(!0);case"toggle":return a.toggle();case"destroy":return a.destroy();case"empty":return a.empty();case"html":return a.html(t)}}catch{}return!1};var C=function(e,t){var n=this,a="trumbowyg-icons",i=r.trumbowyg;n.doc=e.ownerDocument||w,n.$ta=r(e),n.$c=r(e),t=t||{},t.lang!=null||i.langs[t.lang]!=null?n.lang=r.extend(!0,{},i.langs.en,i.langs[t.lang]):n.lang=i.langs.en,n.hideButtonTexts=i.hideButtonTexts!=null?i.hideButtonTexts:t.hideButtonTexts;var s=i.svgPath!=null?i.svgPath:t.svgPath;if(n.hasSvg=s!==!1,s!==!1&&(i.svgAbsoluteUseHref||r("#"+a,n.doc).length===0)){if(s==null){var o=r("script[src]");o.each(function(g,f){var h=f.src,v=h.match("trumbowyg(.min)?.js");v!=null&&(s=h.substring(0,h.indexOf(v[0]))+"ui/icons.svg")})}if(s==null)console.warn("You must define svgPath: https://goo.gl/CfTY9U");else if(!i.svgAbsoluteUseHref){var l=n.doc.createElement("div");l.id=a,n.doc.body.insertBefore(l,n.doc.body.childNodes[0]),r.ajax({async:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"xml",crossDomain:!0,url:s,data:null,beforeSend:null,complete:null,success:function(g){l.innerHTML=new XMLSerializer().serializeToString(g.documentElement)}})}}var c=n.doc.querySelector("base")?p.location.href.split(/[?#]/)[0]:"";n.svgPath=i.svgAbsoluteUseHref?s:c;var d=n.lang.header,u=function(){return(p.chrome||p.Intl&&Intl.v8BreakIterator)&&"CSS"in p};n.btnsDef={viewHTML:{fn:"toggle",class:"trumbowyg-not-disable"},undo:{isSupported:u,key:"Z"},redo:{isSupported:u,key:"Y"},p:{fn:"formatBlock"},blockquote:{fn:"formatBlock"},h1:{fn:"formatBlock",title:d+" 1"},h2:{fn:"formatBlock",title:d+" 2"},h3:{fn:"formatBlock",title:d+" 3"},h4:{fn:"formatBlock",title:d+" 4"},h5:{fn:"formatBlock",title:d+" 5"},h6:{fn:"formatBlock",title:d+" 6"},subscript:{tag:"sub"},superscript:{tag:"sup"},bold:{key:"B",tag:"b"},italic:{key:"I",tag:"i"},underline:{tag:"u"},strikethrough:{tag:"strike"},strong:{fn:"bold",key:"B"},em:{fn:"italic",key:"I"},del:{fn:"strikethrough"},createLink:{key:"K",tag:"a"},unlink:{},insertImage:{},justifyLeft:{tag:"left",forceCss:!0},justifyCenter:{tag:"center",forceCss:!0},justifyRight:{tag:"right",forceCss:!0},justifyFull:{tag:"justify",forceCss:!0},unorderedList:{fn:"insertUnorderedList",tag:"ul"},orderedList:{fn:"insertOrderedList",tag:"ol"},horizontalRule:{fn:"insertHorizontalRule"},removeformat:{},fullscreen:{class:"trumbowyg-not-disable"},close:{fn:"destroy",class:"trumbowyg-not-disable"},formatting:{dropdown:["p","blockquote","h1","h2","h3","h4"],ico:"p"},link:{dropdown:["createLink","unlink"]}},n.o=r.extend(!0,{},i.defaultOptions,t),n.o.hasOwnProperty("imgDblClickHandler")||(n.o.imgDblClickHandler=n.getDefaultImgDblClickHandler()),n.urlPrefix=n.setupUrlPrefix(),n.disabled=n.o.disabled||e.nodeName==="TEXTAREA"&&e.disabled,t.btns?n.o.btns=t.btns:n.o.semantic||(n.o.btns[3]=["bold","italic","underline","strikethrough"]),r.each(n.o.btnsDef,function(g,f){n.addBtnDef(g,f)}),n.eventNamespace="trumbowyg-event",n.keys=[],n.tagToButton={},n.tagHandlers=[],n.pasteHandlers=[].concat(n.o.pasteHandlers),n.isIE=b.userAgent.indexOf("MSIE")!==-1||b.appVersion.indexOf("Trident/")!==-1,n.isMac=b.platform.toUpperCase().indexOf("MAC")!==-1,n.init()};C.prototype={DEFAULT_SEMANTIC_MAP:{b:"strong",i:"em",s:"del",strike:"del",div:"p"},init:function(){var e=this;e.height=e.$ta.height(),e.initPlugins();try{e.doc.execCommand("enableObjectResizing",!1,!1),e.doc.execCommand("defaultParagraphSeparator",!1,"p")}catch{}e.buildEditor(),e.buildBtnPane(),e.fixedBtnPaneEvents(),e.buildOverlay(),setTimeout(function(){e.disabled&&e.setDisabled(!0),e.$c.trigger("tbwinit")})},addBtnDef:function(e,t){this.btnsDef[e]=r.extend(t,this.btnsDef[e]||{})},setupUrlPrefix:function(){var e=this.o.urlProtocol;if(e)return typeof e!="string"?"https://":e.replace("://","")+"://"},buildEditor:function(){var e=this,t=e.o.prefix,n="";e.$box=r("<div/>",{class:t+"box "+t+"editor-visible "+t+e.o.lang+" trumbowyg"}),e.isTextarea=e.$ta.is("textarea"),e.isTextarea?(n=e.$ta.val(),e.$ed=r("<div/>"),e.$box.insertAfter(e.$ta).append(e.$ed,e.$ta)):(e.$ed=e.$ta,n=e.$ed.html(),e.$ta=r("<textarea/>",{name:e.$ta.attr("id"),height:e.height}).val(n),e.$box.insertAfter(e.$ed).append(e.$ta,e.$ed),e.syncCode()),e.$ta.addClass(t+"textarea").attr("tabindex",-1),e.$ed.addClass(t+"editor").attr({contenteditable:!0,dir:e.lang._dir||"ltr"}).html(n),e.o.tabindex&&e.$ed.attr("tabindex",e.o.tabindex),e.$c.is("[placeholder]")&&e.$ed.attr("placeholder",e.$c.attr("placeholder")),e.$c.is("[spellcheck]")&&e.$ed.attr("spellcheck",e.$c.attr("spellcheck")),e.o.resetCss&&e.$ed.addClass(t+"reset-css"),e.o.autogrow||e.$ta.add(e.$ed).css({height:e.height}),e.semanticCode(),e.o.autogrowOnEnter&&e.$ed.addClass(t+"autogrow-on-enter");var a=!1,i=!1,s;e.$ed.on("dblclick","img",e.o.imgDblClickHandler).on("keydown",function(o){var l=o.which;if((l===8||l===13||l===46)&&e.toggleSpan(!0),(o.ctrlKey||o.metaKey)&&!o.altKey){a=!0;var c=e.keys[String.fromCharCode(o.which).toUpperCase()];try{return e.execCmd(c.fn,c.param),!1}catch{}}else if(e.o.tabToIndent&&o.key==="Tab")try{return o.shiftKey?e.execCmd("outdent",!0,null):e.execCmd("indent",!0,null),!1}catch{}}).on("compositionstart compositionupdate",function(){i=!0}).on("keyup compositionend",function(o){if(o.type==="compositionend")i=!1;else if(i)return;var l=o.which;if(!(l>=37&&l<=40)){if((l===8||l===13||l===46)&&e.toggleSpan(),(o.ctrlKey||o.metaKey)&&(l===89||l===90))e.semanticCode(!1,!0),e.$c.trigger("tbwchange");else if(!a&&l!==17){var c=e.isIE?o.type==="compositionend":!0;e.semanticCode(!1,c&&l===13),e.$c.trigger("tbwchange")}else typeof o.which>"u"&&e.semanticCode(!1,!1,!0);setTimeout(function(){a=!1},50)}}).on("mouseup keydown keyup",function(o){(!o.ctrlKey&&!o.metaKey||o.altKey)&&setTimeout(function(){a=!1},50),clearTimeout(s),s=setTimeout(function(){e.updateButtonPaneStatus()},50)}).on("focus blur",function(o){if(o.type==="blur"&&e.clearButtonPaneStatus(),e.$c.trigger("tbw"+o.type),e.o.autogrowOnEnter){if(e.autogrowOnEnterDontClose)return;o.type==="focus"?(e.autogrowOnEnterWasFocused=!0,e.autogrowEditorOnEnter()):e.o.autogrow||(e.$ed.css({height:e.$ed.css("min-height")}),e.$c.trigger("tbwresize"))}}).on("keyup focus",function(){!e.$ta.val().match(/<.*>/)&&!e.$ed.html().match(/<.*>/)&&setTimeout(function(){var o=e.isIE?"<p>":"p";e.doc.execCommand("formatBlock",!1,o),e.syncCode()},0)}).on("cut drop",function(){setTimeout(function(){e.semanticCode(!1,!0),e.$c.trigger("tbwchange")},0)}).on("paste",function(o){if(e.o.removeformatPasted){o.preventDefault(),p.getSelection&&p.getSelection().deleteFromDocument&&p.getSelection().deleteFromDocument();try{var l=p.clipboardData.getData("Text");try{e.doc.selection.createRange().pasteHTML(l)}catch{e.doc.getSelection().getRangeAt(0).insertNode(e.doc.createTextNode(l))}e.$c.trigger("tbwchange",o)}catch{e.execCmd("insertText",(o.originalEvent||o).clipboardData.getData("text/plain"))}}r.each(e.pasteHandlers,function(c,d){d(o)}),setTimeout(function(){e.semanticCode(!1,!0),e.$c.trigger("tbwpaste",o),e.$c.trigger("tbwchange")},0)}),e.$ta.on("keyup",function(){e.$c.trigger("tbwchange")}).on("paste",function(){setTimeout(function(){e.$c.trigger("tbwchange")},0)}),r(e.doc.body).on("keydown."+e.eventNamespace,function(o){if(o.which===27&&r("."+t+"modal-box").length>=1)return e.closeModal(),!1})},autogrowEditorOnEnter:function(){var e=this;e.$ed.removeClass("autogrow-on-enter");var t=e.$ed[0].clientHeight;e.$ed.height("auto");var n=e.$ed[0].scrollHeight;e.$ed.addClass("autogrow-on-enter"),t!==n&&(e.$ed.height(t),setTimeout(function(){e.$ed.css({height:n}),e.$c.trigger("tbwresize")},0))},buildBtnPane:function(){var e=this,t=e.o.prefix,n=e.$btnPane=r("<div/>",{class:t+"button-pane"});r.each(e.o.btns,function(a,i){r.isArray(i)||(i=[i]);var s=r("<div/>",{class:t+"button-group "+(i.indexOf("fullscreen")>=0?t+"right":"")});r.each(i,function(o,l){try{e.isSupportedBtn(l)&&s.append(e.buildBtn(l))}catch{}}),s.html().trim().length>0&&n.append(s)}),e.$box.prepend(n)},buildBtn:function(e){var t=this,n=t.o.prefix,a=t.btnsDef[e],i=a.dropdown,s=a.hasIcon!=null?a.hasIcon:!0,o=t.lang[e]||e,l=r("<button/>",{type:"button",class:n+e+"-button "+(a.class||"")+(s?"":" "+n+"textual-button"),html:t.hasSvg&&s?'<svg><use xlink:href="'+t.svgPath+"#"+n+(a.ico||e).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>':t.hideButtonTexts?"":a.text||a.title||t.lang[e]||e,title:(a.title||a.text||o)+(a.key?" ("+(t.isMac?"Cmd":"Ctrl")+" + "+a.key+")":""),tabindex:-1,mousedown:function(){return(!i||r("."+e+"-"+n+"dropdown",t.$box).is(":hidden"))&&r("body",t.doc).trigger("mousedown"),(t.$btnPane.hasClass(n+"disable")||t.$box.hasClass(n+"disabled"))&&!r(this).hasClass(n+"active")&&!r(this).hasClass(n+"not-disable")||t.execCmd((i?"dropdown":!1)||a.fn||e,a.param||e,a.forceCss),!1}});if(i){l.addClass(n+"open-dropdown");var c=n+"dropdown",d={class:c+"-"+e+" "+c+" "+n+"fixed-top "+(a.dropdownClass||"")};d["data-"+c]=e;var u=r("<div/>",d);r.each(i,function(g,f){t.btnsDef[f]&&t.isSupportedBtn(f)&&u.append(t.buildSubBtn(f))}),t.$box.append(u.hide())}else a.key&&(t.keys[a.key]={fn:a.fn||e,param:a.param||e});return i||(t.tagToButton[(a.tag||e).toLowerCase()]=e),l},buildSubBtn:function(e){var t=this,n=t.o.prefix,a=t.btnsDef[e],i=a.hasIcon!=null?a.hasIcon:!0;return a.key&&(t.keys[a.key]={fn:a.fn||e,param:a.param||e}),t.tagToButton[(a.tag||e).toLowerCase()]=e,r("<button/>",{type:"button",class:n+e+"-dropdown-button "+(a.class||"")+(a.ico?" "+n+a.ico+"-button":""),html:t.hasSvg&&i?'<svg><use xlink:href="'+t.svgPath+"#"+n+(a.ico||e).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>'+(a.text||a.title||t.lang[e]||e):a.text||a.title||t.lang[e]||e,title:a.key?"("+(t.isMac?"Cmd":"Ctrl")+" + "+a.key+")":null,style:a.style||null,mousedown:function(){return r("body",t.doc).trigger("mousedown"),t.execCmd(a.fn||e,a.param||e,a.forceCss),!1}})},isSupportedBtn:function(e){try{return this.btnsDef[e].isSupported()}catch{}return!0},buildOverlay:function(){var e=this;return e.$overlay=r("<div/>",{class:e.o.prefix+"overlay"}).appendTo(e.$box),e.$overlay},showOverlay:function(){var e=this;r(p).trigger("scroll"),e.$overlay.fadeIn(200),e.$box.addClass(e.o.prefix+"box-blur")},hideOverlay:function(){var e=this;e.$overlay.fadeOut(50),e.$box.removeClass(e.o.prefix+"box-blur")},fixedBtnPaneEvents:function(){var e=this,t=e.o.fixedFullWidth,n=e.$box;e.o.fixedBtnPane&&(e.isFixed=!1,r(p).on("scroll."+e.eventNamespace+" resize."+e.eventNamespace,function(){if(n){e.syncCode();var a=r(p).scrollTop(),i=n.offset().top+1,s=e.$btnPane,o=s.outerHeight()-2;a-i>0&&a-i-e.height<0?(e.isFixed||(e.isFixed=!0,s.css({position:"fixed",top:0,left:t?0:"auto",zIndex:7}),e.$box.css({paddingTop:s.height()})),s.css({width:t?"100%":n.width()-1}),r("."+e.o.prefix+"fixed-top",n).css({position:t?"fixed":"absolute",top:t?o:o+(a-i),zIndex:15})):e.isFixed&&(e.isFixed=!1,s.removeAttr("style"),e.$box.css({paddingTop:0}),r("."+e.o.prefix+"fixed-top",n).css({position:"absolute",top:o}))}}))},setDisabled:function(e){var t=this,n=t.o.prefix;t.disabled=e,e?t.$ta.attr("disabled",!0):t.$ta.removeAttr("disabled"),t.$box.toggleClass(n+"disabled",e),t.$ed.attr("contenteditable",!e)},destroy:function(){var e=this,t=e.o.prefix;e.isTextarea?e.$box.after(e.$ta.css({height:""}).val(e.html()).removeClass(t+"textarea").show()):e.$box.after(e.$ed.css({height:""}).removeClass(t+"editor").removeAttr("contenteditable").removeAttr("dir").html(e.html()).show()),e.$ed.off("dblclick","img"),e.destroyPlugins(),e.$box.remove(),e.$c.removeData("trumbowyg"),r("body").removeClass(t+"body-fullscreen"),e.$c.trigger("tbwclose"),r(p).off("scroll."+e.eventNamespace+" resize."+e.eventNamespace),r(e.doc.body).off("keydown."+e.eventNamespace)},empty:function(){this.$ta.val(""),this.syncCode(!0)},toggle:function(){var e=this,t=e.o.prefix;e.o.autogrowOnEnter&&(e.autogrowOnEnterDontClose=!e.$box.hasClass(t+"editor-hidden")),e.semanticCode(!1,!0),e.$c.trigger("tbwchange"),setTimeout(function(){e.doc.activeElement.blur(),e.$box.toggleClass(t+"editor-hidden "+t+"editor-visible"),e.$btnPane.toggleClass(t+"disable"),r("."+t+"viewHTML-button",e.$btnPane).toggleClass(t+"active"),e.$box.hasClass(t+"editor-visible")?e.$ta.attr("tabindex",-1):e.$ta.removeAttr("tabindex"),e.o.autogrowOnEnter&&!e.autogrowOnEnterDontClose&&e.autogrowEditorOnEnter()},0)},toggleSpan:function(e){var t=this;t.$ed.find("span").each(function(){e===!0?r(this).attr("data-tbw-flag",!0):r(this).attr("data-tbw-flag")?r(this).removeAttr("data-tbw-flag"):r(this).contents().unwrap()})},dropdown:function(e){var t=this,n=r("body",t.doc),a=t.o.prefix,i=r("[data-"+a+"dropdown="+e+"]",t.$box),s=r("."+a+e+"-button",t.$btnPane),o=i.is(":hidden");if(n.trigger("mousedown"),o){var l=s.offset().left;s.addClass(a+"active"),i.css({position:"absolute",top:s.offset().top-t.$btnPane.offset().top+s.outerHeight(),left:t.o.fixedFullWidth&&t.isFixed?l:l-t.$btnPane.offset().left}).show(),r(p).trigger("scroll"),n.on("mousedown."+t.eventNamespace,function(c){i.is(c.target)||(r("."+a+"dropdown",t.$box).hide(),r("."+a+"active",t.$btnPane).removeClass(a+"active"),n.off("mousedown."+t.eventNamespace))})}},html:function(e){var t=this;return e!=null?(t.$ta.val(e),t.syncCode(!0),t.$c.trigger("tbwchange"),t):t.$ta.val()},syncTextarea:function(){var e=this;e.$ta.val(e.$ed.text().trim().length>0||e.$ed.find(e.o.tagsToKeep.join(",")).length>0?e.$ed.html():"")},syncCode:function(e){var t=this;if(!e&&t.$ed.is(":visible"))t.syncTextarea();else{var n=r("<div>").html(t.$ta.val()),a=r("<div>").append(n);r(t.o.tagsToRemove.join(","),a).remove(),t.$ed.html(a.contents().html())}if(t.o.autogrow&&(t.height=t.$ed.height(),t.height!==t.$ta.css("height")&&(t.$ta.css({height:t.height}),t.$c.trigger("tbwresize"))),t.o.autogrowOnEnter){t.$ed.height("auto");var i=t.autogrowOnEnterWasFocused?t.$ed[0].scrollHeight:t.$ed.css("min-height");i!==t.$ta.css("height")&&(t.$ed.css({height:i}),t.$c.trigger("tbwresize"))}},semanticCode:function(e,t,n){var a=this;a.saveRange(),a.syncCode(e);var i=!0;if(a.range&&a.range.collapsed&&(i=!1),a.o.semantic){if(a.semanticTag("b",a.o.semanticKeepAttributes),a.semanticTag("i",a.o.semanticKeepAttributes),a.semanticTag("s",a.o.semanticKeepAttributes),a.semanticTag("strike",a.o.semanticKeepAttributes),t){var s=a.o.inlineElementsSelector,o=":not("+s+")";a.$ed.contents().filter(function(){return this.nodeType===3&&this.nodeValue.trim().length>0}).wrap("<span data-tbw/>");var l=function(c){if(c.length!==0){var d=c.nextUntil(o).addBack().wrapAll("<p/>").parent(),u=d.nextAll(s).first();d.next("br").remove(),l(u)}};l(a.$ed.children(s).first()),a.semanticTag("div",!0),r("[data-tbw]",a.$ed).contents().unwrap(),a.$ed.find("p:empty").remove()}!n&&i&&a.restoreRange(),a.syncTextarea()}},semanticTag:function(e,t,n){var a,i=this,s=e;if(this.o.semantic!=null&&typeof this.o.semantic=="object"&&this.o.semantic.hasOwnProperty(e))a=this.o.semantic[e];else if(this.o.semantic===!0&&this.DEFAULT_SEMANTIC_MAP.hasOwnProperty(e))a=this.DEFAULT_SEMANTIC_MAP[e];else return;n&&(e=a,a=s),r(e,this.$ed).each(function(){var o=!1,l=r(this);if(l.contents().length===0)return!1;i.range&&i.range.startContainer.parentNode===this&&(o=!0);var c=r("<"+a+"/>");c.insertBefore(l),t&&r.each(l.prop("attributes"),function(){c.attr(this.name,this.value)}),c.html(l.html()),l.remove(),o===!0&&(i.range.selectNodeContents(c.get(0)),i.range.collapse(!1))})},createLink:function(){for(var e=this,t=e.doc.getSelection(),n=t.getRangeAt(0),a=t.focusNode,i=new XMLSerializer().serializeToString(n.cloneContents())||n+"",s,o,l;["A","DIV"].indexOf(a.nodeName)<0;)a=a.parentNode;if(a&&a.nodeName==="A"){var c=r(a);i=c.text(),s=c.attr("href"),e.o.minimalLinks||(o=c.attr("title"),l=c.attr("target")||e.o.defaultLinkTarget);var d=e.doc.createRange();d.selectNode(a),t.removeAllRanges(),t.addRange(d)}e.saveRange();var u={url:{label:e.lang.linkUrl||"URL",required:!0,value:s},text:{label:e.lang.text,value:i}};e.o.minimalLinks||r.extend(u,{title:{label:e.lang.title,value:o},target:{label:e.lang.target,value:l}}),e.openModalInsert(e.lang.createLink,u,function(g){var f=e.prependUrlPrefix(g.url);if(!f.length)return!1;var h=r(['<a href="',f,'">',g.text||g.url,"</a>"].join(""));return g.title&&h.attr("title",g.title),(g.target||e.o.defaultLinkTarget)&&h.attr("target",g.target||e.o.defaultLinkTarget),e.range.deleteContents(),e.range.insertNode(h[0]),e.syncCode(),e.$c.trigger("tbwchange"),!0})},prependUrlPrefix:function(e){var t=this;if(!t.urlPrefix)return e;var n=/^([a-z][-+.a-z0-9]*:|\/|#)/i;if(n.test(e))return e;var a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return a.test(e)?"mailto:"+e:t.urlPrefix+e},unlink:function(){var e=this,t=e.doc.getSelection(),n=t.focusNode;if(t.isCollapsed){for(;["A","DIV"].indexOf(n.nodeName)<0;)n=n.parentNode;if(n&&n.nodeName==="A"){var a=e.doc.createRange();a.selectNode(n),t.removeAllRanges(),t.addRange(a)}}e.execCmd("unlink",void 0,void 0,!0)},insertImage:function(){var e=this;e.saveRange();var t={url:{label:"URL",required:!0},alt:{label:e.lang.description,value:e.getRangeText()}};e.o.imageWidthModalEdit&&(t.width={}),e.openModalInsert(e.lang.insertImage,t,function(n){e.execCmd("insertImage",n.url,!1,!0);var a=r('img[src="'+n.url+'"]:not([alt])',e.$box);return a.attr("alt",n.alt),e.o.imageWidthModalEdit&&a.attr({width:n.width}),e.syncCode(),e.$c.trigger("tbwchange"),!0})},fullscreen:function(){var e=this,t=e.o.prefix,n=t+"fullscreen",a=n+"-placeholder",i,s=e.$box.outerHeight();e.$box.toggleClass(n),i=e.$box.hasClass(n),i?e.$box.before(r("<div/>",{class:a}).css({height:s})):r("."+a).remove(),r("body").toggleClass(t+"body-fullscreen",i),r(p).trigger("scroll"),e.$c.trigger("tbw"+(i?"open":"close")+"fullscreen")},execCmd:function(e,t,n,a){var i=this;a=!!a||"",e!=="dropdown"&&i.$ed.focus(),e==="strikethrough"&&i.o.semantic&&i.semanticTag("strike",i.o.semanticKeepAttributes,!0);try{i.doc.execCommand("styleWithCSS",!1,n||!1)}catch{}try{i[e+a](t)}catch{try{e(t)}catch{e==="insertHorizontalRule"?t=void 0:e==="formatBlock"&&i.isIE&&(t="<"+t+">"),i.doc.execCommand(e,!1,t),i.syncCode(),i.semanticCode(!1,!0);try{var s=p.getSelection().focusNode;r(p.getSelection().focusNode.parentNode).hasClass("trumbowyg-editor")||(s=p.getSelection().focusNode.parentNode);var o=i.o.tagClasses[t];o&&r(s).addClass(o)}catch{}}e!=="dropdown"&&(i.updateButtonPaneStatus(),i.$c.trigger("tbwchange"))}},openModal:function(e,t,n){var a=this,i=a.o.prefix;if(n=n!==!1,r("."+i+"modal-box",a.$box).length>0)return!1;a.o.autogrowOnEnter&&(a.autogrowOnEnterDontClose=!0),a.saveRange(),a.showOverlay(),a.$btnPane.addClass(i+"disable");var s=r("<div/>",{class:i+"modal "+i+"fixed-top"}).css({top:a.$box.offset().top+a.$btnPane.height(),zIndex:99999}).appendTo(r(a.doc.body));a.$overlay.one("click",function(){return s.trigger(y),!1});var o;n?o=r("<form/>",{action:"",html:t}).on("submit",function(){return s.trigger(m),!1}).on("reset",function(){return s.trigger(y),!1}).on("submit reset",function(){a.o.autogrowOnEnter&&(a.autogrowOnEnterDontClose=!1)}):o=t;var l=r("<div/>",{class:i+"modal-box",html:o}).css({top:"-"+a.$btnPane.outerHeight(),opacity:0,paddingBottom:n?null:"5%"}).appendTo(s).animate({top:0,opacity:1},100);return e&&r("<span/>",{text:e,class:i+"modal-title"}).prependTo(l),n&&(r(":input:first",l).focus(),a.buildModalBtn("submit",l),a.buildModalBtn("reset",l),s.height(l.outerHeight()+10)),r(p).trigger("scroll"),a.$c.trigger("tbwmodalopen"),s},buildModalBtn:function(e,t){var n=this,a=n.o.prefix;return r("<button/>",{class:a+"modal-button "+a+"modal-"+e,type:e,text:n.lang[e]||e}).appendTo(r("form",t))},closeModal:function(){var e=this,t=e.o.prefix;e.$btnPane.removeClass(t+"disable"),e.$overlay.off();var n=r("."+t+"modal-box",r(e.doc.body));n.animate({top:"-"+n.height()},100,function(){n.parent().remove(),e.hideOverlay(),e.$c.trigger("tbwmodalclose")}),e.restoreRange()},openModalInsert:function(e,t,n){var a=this,i=a.o.prefix,s=a.lang,o="",l=i+"form-"+Date.now()+"-";return r.each(t,function(c,d){var u=d.label||c,g=d.name||c,f=d.attributes||{},h=l+c,v=Object.keys(f).map(function(x){return x+'="'+f[x]+'"'}).join(" ");typeof d.type=="function"?(d.name||(d.name=g),o+=d.type(d,h,i,s)):(o+='<div class="'+i+'input-row"><div class="'+i+'input-infos"><label for="'+h+'"><span>'+(s[u]?s[u]:u)+'</span></label></div><div class="'+i+'input-html"><input id="'+h+'" type="'+(d.type||"text")+'" name="'+g+'" '+v,o+=(d.type==="checkbox"&&d.value?' checked="checked"':"")+' value="'+(d.value||"").replace(/"/g,"&quot;")+'"></div>',o+="</div>")}),a.openModal(e,o).on(m,function(){var c=r("form",r(this)),d=!0,u={};r.each(t,function(g,f){var h=f.name||g,v=r(':input[name="'+h+'"]',c),x=v[0].type;switch(x.toLowerCase()){case"checkbox":u[h]=v.is(":checked");break;case"radio":u[h]=v.filter(":checked").val();break;default:u[h]=r.trim(v.val());break}f.required&&u[h]===""?(d=!1,a.addErrorOnModalField(v,a.lang.required)):f.pattern&&!f.pattern.test(u[h])&&(d=!1,a.addErrorOnModalField(v,f.patternError))}),d&&(a.restoreRange(),n(u,t)&&(a.syncCode(),a.$c.trigger("tbwchange"),a.closeModal(),r(this).off(m)))}).one(y,function(){r(this).off(m),a.closeModal()})},addErrorOnModalField:function(e,t){var n=this.o.prefix,a=n+"msg-error",i=e.closest("."+n+"input-row");e.on("change keyup",function(){i.removeClass(n+"input-error"),setTimeout(function(){i.find("."+a).remove()},150)}),i.addClass(n+"input-error").find("."+n+"input-infos label").append(r("<span/>",{class:a,text:t}))},getDefaultImgDblClickHandler:function(){var e=this;return function(){var t=r(this),n=t.attr("src"),a="(Base64)";n.indexOf("data:image")===0&&(n=a);var i={url:{label:"URL",value:n,required:!0},alt:{label:e.lang.description,value:t.attr("alt")}};return e.o.imageWidthModalEdit&&(i.width={value:t.attr("width")?t.attr("width"):""}),e.openModalInsert(e.lang.insertImage,i,function(s){return s.url!==a&&t.attr({src:s.url}),t.attr({alt:s.alt}),e.o.imageWidthModalEdit&&(parseInt(s.width)>0?t.attr({width:s.width}):t.removeAttr("width")),!0}),!1}},saveRange:function(){var e=this,t=e.doc.getSelection();if(e.range=null,!(!t||!t.rangeCount)){var n=e.range=t.getRangeAt(0),a=e.doc.createRange(),i;a.selectNodeContents(e.$ed[0]),a.setEnd(n.startContainer,n.startOffset),i=(a+"").length,e.metaRange={start:i,end:i+(n+"").length}}},restoreRange:function(){var e=this,t=e.metaRange,n=e.range,a=e.doc.getSelection(),i;if(n){if(t&&t.start!==t.end){var s=0,o=[e.$ed[0]],l,c=!1,d=!1;for(i=e.doc.createRange();!d&&(l=o.pop());)if(l.nodeType===3){var u=s+l.length;!c&&t.start>=s&&t.start<=u&&(i.setStart(l,t.start-s),c=!0),c&&t.end>=s&&t.end<=u&&(i.setEnd(l,t.end-s),d=!0),s=u}else for(var g=l.childNodes,f=g.length;f>0;)f-=1,o.push(g[f])}try{a.removeAllRanges()}catch{}a.addRange(i||n)}},getRangeText:function(){return this.range+""},clearButtonPaneStatus:function(){var e=this,t=e.o.prefix,n=t+"active-button "+t+"active",a=t+"original-icon";r("."+t+"active-button",e.$btnPane).removeClass(n),r("."+a,e.$btnPane).each(function(){r(this).find("svg use").attr("xlink:href",r(this).data(a))})},updateButtonPaneStatus:function(){var e=this,t=e.o.prefix,n=t+"active-button "+t+"active",a=t+"original-icon",i=e.getTagsRecursive(e.doc.getSelection().focusNode);e.clearButtonPaneStatus(),r.each(i,function(s,o){var l=e.tagToButton[o.toLowerCase()],c=r("."+t+l+"-button",e.$btnPane);if(c.length>0)c.addClass(n);else try{c=r("."+t+"dropdown ."+t+l+"-dropdown-button",e.$box);var d=c.find("svg use"),u=c.parent().data(t+"dropdown"),g=r("."+t+u+"-button",e.$box),f=g.find("svg use");g.addClass(n),e.o.changeActiveDropdownIcon&&d.length>0&&(g.addClass(a).data(a,f.attr("xlink:href")),f.attr("xlink:href",d.attr("xlink:href")))}catch{}})},getTagsRecursive:function(e,t){var n=this;if(t=t||(e&&e.tagName?[e.tagName]:[]),e&&e.parentNode)e=e.parentNode;else return t;var a=e.tagName;return a==="DIV"?t:(a==="P"&&e.style.textAlign!==""&&t.push(e.style.textAlign),r.each(n.tagHandlers,function(i,s){t=t.concat(s(e,n))}),t.push(a),n.getTagsRecursive(e,t).filter(function(i){return i!=null}))},initPlugins:function(){var e=this;e.loadedPlugins=[],r.each(r.trumbowyg.plugins,function(t,n){(!n.shouldInit||n.shouldInit(e))&&(n.init(e),n.tagHandler&&e.tagHandlers.push(n.tagHandler),e.loadedPlugins.push(n))})},destroyPlugins:function(){var e=this;r.each(this.loadedPlugins,function(t,n){n.destroy&&n.destroy(e)})}}})(navigator,window,document,jQuery);$(".trumbowyg-form").trumbowyg({svgPath:"/resources/icons.svg"});$("#sidenavToggler").click(function(b){b.preventDefault(),$("body").toggleClass("sidenav-toggled")});$('.navbar-sidenav [data-toggle="tooltip"]').tooltip({template:'<div class="tooltip navbar-sidenav-tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>'});
